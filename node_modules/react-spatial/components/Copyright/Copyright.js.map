{"version":3,"file":"Copyright.js","sources":["../../../src/components/Copyright/Copyright.js"],"sourcesContent":["import React, { useMemo, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Map } from 'ol';\nimport CopyrightControl from 'mobility-toolbox-js/ol/controls/CopyrightControl';\n\nconst propTypes = {\n  /**\n   * A map.\n   */\n  map: PropTypes.instanceOf(Map).isRequired,\n\n  /**\n   * Format function. Called with an array of copyrights from visible layers\n   * and returns the copyright.\n   */\n  format: PropTypes.func,\n\n  /**\n   * CSS class of th root element\n   */\n  className: PropTypes.string,\n};\n\nconst defaultProps = {\n  format: (copyrights) => copyrights.join(' | '),\n  className: 'rs-copyright',\n};\n\n/**\n * The Copyright component uses the\n * [mobility-toolbox-js CopyrightControl](https://mobility-toolbox-js.geops.io/api/class/src/mapbox/controls/CopyrightControl%20js~CopyrightControl%20html-offset-anchor)\n * to render the layer copyrights.\n */\nfunction Copyright({ map, format, ...other }) {\n  const [copyrights, setCopyrights] = useState([]);\n\n  const control = useMemo(() => {\n    return new CopyrightControl({\n      target: document.createElement('div'),\n      element: document.createElement('div'),\n      render() {\n        // eslint-disable-next-line react/no-this-in-sfc\n        const newCopyrights = this.getCopyrights();\n        if (copyrights.toString() !== newCopyrights.toString()) {\n          setCopyrights(newCopyrights);\n        }\n      },\n    });\n  }, []);\n\n  // Ensure the control is not associated to the wrong map\n  useEffect(() => {\n    if (!control) {\n      return () => {};\n    }\n\n    control.map = map;\n\n    return () => {\n      control.map = null;\n    };\n  }, [map, control]);\n\n  if (!control || !control.getCopyrights().length) {\n    return null;\n  }\n\n  return (\n    <div\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      {...other}\n      // eslint-disable-next-line react/no-danger\n      dangerouslySetInnerHTML={{\n        __html: format(copyrights) || '',\n      }}\n    />\n  );\n}\n\nCopyright.propTypes = propTypes;\nCopyright.defaultProps = defaultProps;\n\nexport default React.memo(Copyright);\n"],"names":["const"],"mappings":";AAAA,OAAO,KAAK,IAAI,OAAO,EAAE,SAAS,EAAE,QAAQ,QAAQ,OAAO,CAAC;AAC5D,OAAO,SAAS,MAAM,YAAY,CAAC;AACnC,SAAS,GAAG,QAAQ,IAAI,CAAC;AACzB,OAAO,gBAAgB,MAAM,kDAAkD,CAAC;AAChF;AACAA,GAAK,CAAC,SAAS,GAAG;AAClB;AACA;AACA;AACA,EAAE,GAAG,EAAE,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,UAAU;AAC3C;AACA;AACA;AACA;AACA;AACA,EAAE,MAAM,EAAE,SAAS,CAAC,IAAI;AACxB;AACA;AACA;AACA;AACA,EAAE,SAAS,EAAE,SAAS,CAAC,MAAM;AAC7B,CAAC,CAAC;AACF;AACAA,GAAK,CAAC,YAAY,GAAG;AACrB,EAAE,MAAM,WAAE,CAAC,UAAU,WAAK,UAAU,CAAC,IAAI,CAAC,KAAK,IAAC;AAChD,EAAE,SAAS,EAAE,cAAc;AAC3B,CAAC,CAAC;AACF;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,SAAS,IAA0B,EAAE,CAAzB;oBAAK;0BAAQ;+DAAG;;AAAU;AAC/C,WAAmC,GAAG,QAAQ,CAAC,EAAE;EAAxC;EAAY,6BAA8B;AACnD;AACA,EAAEA,GAAK,CAAC,OAAO,GAAG,OAAO,UAAC,GAAM;AAChC,IAAI,OAAO,IAAI,gBAAgB,CAAC;AAChC,MAAM,MAAM,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;AAC3C,MAAM,OAAO,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;AAC5C,MAAM,uBAAM,GAAG;AACf;AACA,QAAQA,GAAK,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;AACnD,QAAQ,IAAI,UAAU,CAAC,QAAQ,EAAE,KAAK,aAAa,CAAC,QAAQ,EAAE,EAAE;AAChE,UAAU,aAAa,CAAC,aAAa,CAAC,CAAC;AACvC,SAAS;AACT,OAAO;AACP,KAAK,CAAC,CAAC;AACP,GAAG,EAAE,EAAE,CAAC,CAAC;AACT;AACA;AACA,EAAE,SAAS,UAAC,GAAM;AAClB,IAAI,IAAI,CAAC,OAAO,EAAE;AAClB,MAAM,gBAAO,GAAM,EAAE,CAAC;AACtB,KAAK;AACL;AACA,IAAI,OAAO,CAAC,GAAG,GAAG,GAAG,CAAC;AACtB;AACA,IAAI,gBAAO,GAAM;AACjB,MAAM,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC;AACzB,KAAK,CAAC;AACN,GAAG,EAAE,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC,CAAC;AACrB;AACA,EAAE,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC,MAAM,EAAE;AACnD,IAAI,OAAO,IAAI,CAAC;AAChB,GAAG;AACH;AACA,EAAE,OAAO;AACT,IAAI,sBAAC,uBAAG;AACR;AACA,MAAU,KAAM,IAEV,yBAAyB;AAC/B,QAAQ,MAAM,EAAE,MAAM,CAAC,UAAU,CAAC,IAAI,EAAE;AACxC,UAAQ,CACF;AACN,GAAG,CAAC;AACJ,CAAC;AACD;AACA,SAAS,CAAC,SAAS,GAAG,SAAS,CAAC;AAChC,SAAS,CAAC,YAAY,GAAG,YAAY,CAAC;AACtC;AACA,eAAe,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;"}