{"version":3,"file":"MousePosition.js","sources":["../../../src/components/MousePosition/MousePosition.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport OLMap from 'ol/Map';\nimport { createStringXY } from 'ol/coordinate';\nimport OLMousePosition from 'ol/control/MousePosition';\n\nconst propTypes = {\n  /**\n   * An [ol/map](https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html).\n   */\n  map: PropTypes.instanceOf(OLMap).isRequired,\n\n  /**\n   * List of projections to display.\n   */\n  projections: PropTypes.arrayOf(\n    PropTypes.shape({\n      /**\n       * The label to display in the select box.\n       */\n      label: PropTypes.string.isRequired,\n\n      /**\n       * The value used to create the options´s projection of the MousePosition control.\n       * See [doc](https://openlayers.org/en/latest/apidoc/module-ol_control_MousePosition.html).\n       */\n      value: PropTypes.string.isRequired,\n\n      /**\n       * A function following the  [CoordinateFormat](https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~CoordinateFormat).\n       */\n      format: PropTypes.func,\n    }),\n  ),\n\n  /**\n   * The initially selected projection\n   */\n  projectionValue: PropTypes.shape({\n    /**\n     * The label to display in the select box.\n     */\n    label: PropTypes.string.isRequired,\n\n    /**\n     * The value used to create the options´s projection of the MousePosition control.\n     * See [doc](https://openlayers.org/en/latest/apidoc/module-ol_control_MousePosition.html).\n     */\n    value: PropTypes.string.isRequired,\n\n    /**\n     * A function following the  [CoordinateFormat](https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~CoordinateFormat).\n     */\n    format: PropTypes.func,\n  }),\n\n  /**\n   * Function triggered on projection's change event.\n   * @param {Event} event The change event object.\n   * @param {Object} projection The selected projection object.\n   */\n  onChange: PropTypes.func,\n};\n\nconst defaultProps = {\n  onChange: () => {},\n  projections: [\n    {\n      label: 'EPSG:4326',\n      value: 'EPSG:4326',\n    },\n    {\n      label: 'EPSG:3857',\n      value: 'EPSG:3857',\n    },\n  ],\n  projectionValue: null,\n};\n\n/**\n * The MousePosition component renders a select box with map projection options\n * and the cursor position in coordinates using the selected projection.\n */\nfunction MousePosition({\n  map,\n  projections,\n  projectionValue,\n  onChange,\n  ...other\n}) {\n  const [projection, setProjection] = useState(\n    projections &&\n      ((projectionValue &&\n        projections.find((p) => p.value === projectionValue.value)) ||\n        projections[0]),\n  );\n  const [control, setControl] = useState();\n  const ref = useRef();\n\n  useEffect(() => {\n    const mousePosition = new OLMousePosition({\n      target: ref.current,\n      undefinedHTML: '&nbsp;',\n      className: '',\n    });\n    map.addControl(mousePosition);\n    setControl(mousePosition);\n\n    return () => {\n      map.removeControl(mousePosition);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!projection || !control) {\n      return;\n    }\n    control.setProjection(projection.value);\n    control.setCoordinateFormat(projection.format || createStringXY(4));\n  }, [projection, control]);\n\n  useEffect(() => {\n    if (projections) {\n      const proj =\n        (projectionValue &&\n          projections.find((p) => p.value === projectionValue.value)) ||\n        projections[0];\n      setProjection(proj);\n    }\n  }, [projectionValue]);\n\n  const onChangeCb = useCallback(\n    (evt) => {\n      const newProj = projections.find((opt) => evt.target.value === opt.value);\n      setProjection(newProj);\n      onChange(evt, newProj);\n    },\n    [projections],\n  );\n\n  if (!projection || !projections || !projections.length) {\n    return null;\n  }\n\n  return (\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    <div className=\"rs-mouse-position\" {...other}>\n      <select\n        className=\"rs-select\"\n        value={projection.value}\n        onChange={onChangeCb}\n      >\n        {projections.map((option) => (\n          <option key={option.value} value={option.value}>\n            {option.label}\n          </option>\n        ))}\n      </select>\n      <span ref={ref} className=\"rs-coordinates\" />\n    </div>\n  );\n}\n\nMousePosition.propTypes = propTypes;\nMousePosition.defaultProps = defaultProps;\n\nexport default React.memo(MousePosition);\n"],"names":["const"],"mappings":"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"}