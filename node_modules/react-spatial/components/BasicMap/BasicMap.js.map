{"version":3,"file":"BasicMap.js","sources":["../../../src/components/BasicMap/BasicMap.js"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { defaults as defaultInteractions } from 'ol/interaction';\nimport { equals } from 'ol/extent';\nimport OLMap from 'ol/Map';\nimport OLCollection from 'ol/Collection';\nimport View from 'ol/View';\nimport { unByKey } from 'ol/Observable';\nimport Interaction from 'ol/interaction/Interaction';\nimport { Layer } from 'mobility-toolbox-js/ol';\nimport ResizeHandler from '../ResizeHandler';\n\nconst propTypes = {\n  /** Map animation options */\n  animationOptions: PropTypes.shape({\n    center: PropTypes.arrayOf(PropTypes.number),\n    resolution: PropTypes.number,\n    zoom: PropTypes.number,\n  }),\n\n  /** Center of the [ol/View](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html). */\n  center: PropTypes.arrayOf(PropTypes.number),\n\n  /** Class name of the map container */\n  className: PropTypes.string,\n\n  /** Map extent */\n  extent: PropTypes.arrayOf(PropTypes.number),\n\n  /** Openlayers [fit options](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html#fit) when extent is updated */\n  fitOptions: PropTypes.object,\n\n  /** Array of [ol/interaction](https://openlayers.org/en/latest/apidoc/module-ol_interaction_Interaction-Interaction.html). */\n  interactions: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.instanceOf(Interaction)),\n    PropTypes.instanceOf(OLCollection),\n  ]),\n\n  /** Array of [mobility-toolbox-js layers](https://mobility-toolbox-js.geops.io/api/identifiers%20html#ol-layers) to display. */\n  layers: PropTypes.arrayOf(PropTypes.instanceOf(Layer)),\n\n  /** An [ol/map](https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html). */\n  map: PropTypes.instanceOf(OLMap),\n\n  /**\n   * Callback when a [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html) is clicked.\n   * @param {OLFeature[]} features An array of [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html).\n   * @param {ol.MapBrowserEvent} event The singleclick [ol/MapBrowserEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:singleclick).\n   */\n  onFeaturesClick: PropTypes.func,\n\n  /**\n   * Optional options to pass on feature click. Passed to ol's 'getFeaturesAtPixel' method.\n   * https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html#getFeaturesAtPixel\n   */\n  featuresClickOptions: PropTypes.shape({\n    layerFilter: PropTypes.func,\n    hitTolerance: PropTypes.number,\n    checkWrapped: PropTypes.bool,\n  }),\n\n  /**\n   * Callback when a [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html) is hovered.\n   * @param {OLFeature[]} features An array of [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html).\n   * @param {ol.MapBrowserEvent} event The pointermove [ol/MapBrowserEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:pointermove).\n   */\n  onFeaturesHover: PropTypes.func,\n\n  /**\n   * Callback when the map was moved.\n   * @param {ol.MapEvent} event The movend [ol/MapEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:moveend).\n   */\n  onMapMoved: PropTypes.func,\n\n  /** Map resolution */\n  resolution: PropTypes.number,\n\n  /** The tabIndex of the map. */\n  tabIndex: PropTypes.number,\n\n  /** The style of the map. */\n  style: PropTypes.object,\n\n  /** HTML aria-label. */\n  ariaLabel: PropTypes.string,\n\n  /** [ol/View](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html) constructor options */\n  viewOptions: PropTypes.shape({\n    minZoom: PropTypes.number,\n    maxZoom: PropTypes.number,\n    extent: PropTypes.array,\n    projection: PropTypes.string,\n  }),\n\n  /** Map zoom level */\n  zoom: PropTypes.number,\n};\n\nconst defaultProps = {\n  animationOptions: undefined,\n  center: [0, 0],\n  className: 'rs-map',\n  extent: undefined,\n  fitOptions: {\n    duration: 1000,\n    padding: [20, 20, 20, 20],\n    maxZoom: 23,\n  },\n  style: undefined,\n  interactions: null,\n  layers: [],\n  map: null,\n  onFeaturesClick: undefined,\n  featuresClickOptions: {\n    hitTolerance: 0,\n  },\n  onFeaturesHover: undefined,\n  onMapMoved: undefined,\n  resolution: undefined,\n  tabIndex: undefined,\n  ariaLabel: 'map',\n  viewOptions: {\n    minZoom: 0,\n    maxZoom: 22,\n    extent: undefined,\n    projection: 'EPSG:3857',\n  },\n  zoom: 1,\n};\n\n/**\n * The BasicMap component renders an [ol/map](https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html).\n *\n * The map's view is created with the following parameters for the view:\n *  - projection: 'EPSG:3857'\n *  - zoom: 0\n *  - minZoom: 0\n *  - maxZoom: 22\n *\n * These options can be overridden using the viewOptions property.\n */\nclass BasicMap extends PureComponent {\n  constructor(props) {\n    super(props);\n    const { map, interactions } = this.props;\n\n    this.map =\n      map ||\n      new OLMap({\n        controls: [],\n        interactions:\n          interactions ||\n          defaultInteractions({\n            altShiftDragRotate: false,\n            pinchRotate: false,\n          }),\n      });\n\n    this.state = {\n      node: null,\n    };\n\n    this.layers = [];\n    this.moveEndRef = null;\n    this.singleClickRef = null;\n    this.pointerMoveRef = null;\n    this.setNode = this.setNode.bind(this);\n  }\n\n  componentDidMount() {\n    const {\n      layers,\n      extent,\n      viewOptions,\n      center,\n      zoom,\n      resolution,\n    } = this.props;\n    const { node } = this.state;\n    this.map.setTarget(node);\n\n    // We set the view here otherwise the map is not correctly zoomed.\n    this.map.setView(new View({ ...viewOptions, center, zoom, resolution }));\n\n    // // Since ol 6.1.0 touch-action is set to auto and creates a bad navigation experience on mobile,\n    // // so we have to force it to none for mobile.\n    // // https://github.com/openlayers/openlayers/pull/10187/files\n    const viewPort = this.map.getViewport();\n    viewPort.style.touchAction = 'none';\n    viewPort.style.msTouchAction = 'none';\n    viewPort.setAttribute('touch-action', 'none');\n\n    // Fit only work if the map has a size.\n    if (this.map.getSize() && extent) {\n      this.map.getView().fit(extent);\n    }\n\n    this.setLayers(layers);\n    this.listenMoveEnd();\n    this.listenSingleClick();\n    this.listenPointerMove();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const {\n      animationOptions,\n      center,\n      extent,\n      fitOptions,\n      layers,\n      resolution,\n      viewOptions,\n      zoom,\n      onMapMoved,\n      onFeaturesClick,\n      onFeaturesHover,\n    } = this.props;\n    const { node } = this.state;\n\n    if (prevState.node !== node) {\n      this.map.setTarget(node);\n\n      // When the node is set we reinitialize the extent with the extent property.\n      if (!prevState.node && node && extent) {\n        this.map.getView().fit(extent);\n      }\n    }\n\n    if (prevProps.layers !== layers) {\n      this.setLayers(layers);\n    }\n\n    // Creates a new view if necessary before updating the others prop.\n    if (\n      viewOptions &&\n      JSON.stringify(viewOptions) !== JSON.stringify(prevProps.viewOptions)\n    ) {\n      // Re-create a view, ol doesn't provide any method to setExtent of view.\n      this.map.setView(\n        new View({\n          ...viewOptions,\n          center,\n          resolution,\n          zoom,\n        }),\n      );\n    }\n\n    const view = this.map.getView();\n\n    if (animationOptions && prevProps.animationOptions !== animationOptions) {\n      view.animate(animationOptions);\n    }\n\n    if (prevProps.center !== center) {\n      view.setCenter(center);\n    }\n\n    if (zoom !== prevProps.zoom) {\n      view.setZoom(zoom);\n    }\n\n    if (resolution !== prevProps.resolution) {\n      view.setResolution(resolution);\n    }\n\n    if (extent && !equals(extent, prevProps.extent || [])) {\n      view.fit(extent, fitOptions);\n    }\n\n    if (onMapMoved !== prevProps.onMapMoved) {\n      this.listenMoveEnd();\n    }\n\n    if (onFeaturesClick !== prevProps.onFeaturesClick) {\n      this.listenSingleClick();\n    }\n\n    if (onFeaturesHover !== prevProps.onFeaturesHover) {\n      this.listenPointerMove();\n    }\n  }\n\n  componentWillUnmount() {\n    unByKey([this.moveEndRef, this.singleClickRef, this.pointerMoveRef]);\n  }\n\n  setNode(node) {\n    this.setState({ node });\n  }\n\n  setLayers(layers = []) {\n    const layersToRemove = this.layers.filter(\n      (layer) => !layers.includes(layer),\n    );\n    for (let i = 0; i < layersToRemove.length; i += 1) {\n      this.terminateLayer(layersToRemove[i]);\n    }\n\n    const layersToInit = layers.filter((layer) => !this.layers.includes(layer));\n    for (let i = 0; i < layersToInit.length; i += 1) {\n      this.initLayer(layersToInit[i]);\n    }\n    this.layers = layers;\n  }\n\n  initLayer(layer) {\n    layer.init(this.map);\n    if (\n      layer.olLayer &&\n      this.map.getLayers() &&\n      !this.map.getLayers().getArray().includes(layer.olLayer)\n    ) {\n      this.map.addLayer(layer.olLayer);\n    }\n    const layers = layer.children || [];\n    for (let i = 0; i < layers.length; i += 1) {\n      this.initLayer(layers[i]);\n    }\n  }\n\n  terminateLayer(layer) {\n    if (\n      layer.olLayer &&\n      this.map.getLayers() &&\n      this.map.getLayers().getArray().includes(layer.olLayer)\n    ) {\n      this.map.removeLayer(layer.olLayer);\n    }\n    layer.terminate(this.map);\n    const layers = layer.children || [];\n    for (let i = 0; i < layers.length; i += 1) {\n      this.terminateLayer(layers[i]);\n    }\n  }\n\n  listenMoveEnd() {\n    const { onMapMoved } = this.props;\n    unByKey(this.moveEndRef);\n\n    if (!onMapMoved) {\n      return;\n    }\n\n    this.moveEndRef = this.map.on('moveend', (evt) => onMapMoved(evt));\n  }\n\n  listenSingleClick() {\n    const { onFeaturesClick, featuresClickOptions } = this.props;\n    unByKey(this.singleClickRef);\n\n    if (!onFeaturesClick) {\n      return;\n    }\n\n    this.singleClickRef = this.map.on('singleclick', (evt) => {\n      const features = evt.map.getFeaturesAtPixel(\n        evt.pixel,\n        featuresClickOptions,\n      );\n      onFeaturesClick(features || [], evt);\n    });\n  }\n\n  listenPointerMove() {\n    const { onFeaturesHover } = this.props;\n    unByKey(this.pointerMoveRef);\n\n    if (!onFeaturesHover) {\n      return;\n    }\n\n    this.pointerMoveRef = this.map.on('pointermove', (evt) => {\n      const features = evt.map.getFeaturesAtPixel(evt.pixel);\n      onFeaturesHover(features || [], evt);\n    });\n  }\n\n  render() {\n    const { className, tabIndex, ariaLabel, style } = this.props;\n    const { node } = this.state;\n    return (\n      <div\n        className={className}\n        ref={this.setNode}\n        role=\"presentation\"\n        aria-label={ariaLabel}\n        tabIndex={tabIndex}\n        style={style}\n      >\n        <ResizeHandler\n          maxHeightBrkpts={null}\n          maxWidthBrkpts={null}\n          observe={node}\n          onResize={() => {\n            this.map.updateSize();\n          }}\n        />\n      </div>\n    );\n  }\n}\n\nBasicMap.propTypes = propTypes;\nBasicMap.defaultProps = defaultProps;\n\nexport default BasicMap;\n"],"names":["const","super","i","let","this"],"mappings":"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"}