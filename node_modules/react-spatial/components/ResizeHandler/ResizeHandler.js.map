{"version":3,"file":"ResizeHandler.js","sources":["../../../src/components/ResizeHandler/ResizeHandler.js"],"sourcesContent":["import ReactDOM from 'react-dom';\nimport { PureComponent, Component } from 'react';\nimport PropTypes from 'prop-types';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nconst propTypes = {\n  observe: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.instanceOf(Element),\n    PropTypes.instanceOf(Component),\n    PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n    PropTypes.shape({ current: PropTypes.instanceOf(Component) }),\n  ]),\n  maxHeightBrkpts: PropTypes.objectOf(PropTypes.number),\n  maxWidthBrkpts: PropTypes.objectOf(PropTypes.number),\n  stylePropHeight: PropTypes.string,\n  onResize: PropTypes.func,\n\n  // This property is used to re-apply the classes, for example when the className of the observed node changes.\n  forceUpdate: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n    PropTypes.bool,\n  ]),\n};\n\n// Same as bootstrap\nconst defaultProps = {\n  observe: null,\n  maxHeightBrkpts: {\n    xs: 576,\n    s: 768,\n    m: 992,\n    l: 1200,\n    xl: Infinity,\n  },\n  maxWidthBrkpts: {\n    xs: 576,\n    s: 768,\n    m: 992,\n    l: 1200,\n    xl: Infinity,\n  },\n  stylePropHeight: null,\n  onResize: null,\n  forceUpdate: null,\n};\n/**\n * This component adds css class to an element depending on his size.\n */\nclass ResizeHandler extends PureComponent {\n  static applyBreakpoints(entry, breakpoints, size, direction) {\n    let found = false;\n    let screenSize;\n    Object.entries(breakpoints).forEach((brkpt) => {\n      const cssClass = `rs-${direction}-${brkpt[0]}`;\n      entry.target.classList.remove(cssClass);\n      if (!found && size <= brkpt[1]) {\n        found = true;\n        [screenSize] = brkpt;\n        entry.target.classList.add(cssClass);\n      }\n    });\n    return screenSize;\n  }\n\n  constructor(props) {\n    super(props);\n    this.observer = new ResizeObserver((entries) => this.onResize(entries));\n    this.nodes = [];\n  }\n\n  componentDidMount() {\n    this.observe();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { observe, forceUpdate } = this.props;\n\n    if (\n      observe !== prevProps.observe ||\n      forceUpdate !== prevProps.forceUpdate\n    ) {\n      this.observe();\n    }\n  }\n\n  componentWillUnmount() {\n    this.observer.disconnect();\n  }\n\n  onResize(entries) {\n    const {\n      maxHeightBrkpts,\n      maxWidthBrkpts,\n      stylePropHeight,\n      onResize,\n    } = this.props;\n\n    if (stylePropHeight) {\n      const vh = window.innerHeight * 0.01;\n      document.documentElement.style.setProperty(stylePropHeight, `${vh}px`);\n    }\n\n    if (!maxWidthBrkpts && !maxHeightBrkpts) {\n      onResize(entries);\n      return;\n    }\n\n    let newScreenWidth;\n    let newScreenHeight;\n\n    for (let i = 0; i < entries.length; i += 1) {\n      const entry = entries[i];\n      const rect = entry.contentRect;\n      const { height, width } = rect;\n\n      if (maxWidthBrkpts) {\n        newScreenWidth = ResizeHandler.applyBreakpoints(\n          entry,\n          maxWidthBrkpts,\n          width,\n          'w',\n        );\n      }\n      if (maxHeightBrkpts) {\n        newScreenHeight = ResizeHandler.applyBreakpoints(\n          entry,\n          maxHeightBrkpts,\n          height,\n          'h',\n        );\n      }\n    }\n\n    if (onResize) {\n      onResize(entries, newScreenWidth, newScreenHeight);\n    }\n  }\n\n  observe() {\n    this.observer.disconnect();\n    const { observe } = this.props;\n\n    if (!observe) {\n      return;\n    }\n\n    if (typeof observe === 'string' || observe instanceof String) {\n      this.nodes = document.querySelectorAll(observe);\n    } else if (observe instanceof Component) {\n      // eslint-disable-next-line react/no-find-dom-node\n      this.nodes.push(ReactDOM.findDOMNode(observe));\n    } else if (observe instanceof Element) {\n      this.nodes.push(observe);\n    } else if (observe.current instanceof Element) {\n      // observe value created with React.createRef() on a html node.\n      this.nodes.push(observe.current);\n    } else if (observe.current instanceof Component) {\n      // observe value created with React.createRef() on a React component.\n      // eslint-disable-next-line react/no-find-dom-node\n      this.nodes.push(ReactDOM.findDOMNode(observe.current));\n    }\n\n    if (this.nodes.length) {\n      this.nodes.forEach((node) => this.observer.observe(node));\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n\nResizeHandler.propTypes = propTypes;\nResizeHandler.defaultProps = defaultProps;\n\nexport default ResizeHandler;\n"],"names":["const","let","super","this"],"mappings":"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"}