{"version":3,"file":"TrackerControl.js","sources":["../../../src/components/TrackerControl/TrackerControl.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { IoIosSpeedometer } from 'react-icons/io';\nimport { FaPlay, FaForward, FaBackward, FaRegDotCircle } from 'react-icons/fa';\nimport { TrackerLayer } from 'mobility-toolbox-js/ol';\n\nconst increaseSpeed = (speed) => {\n  let delta = 0.1;\n  if (speed >= 1) {\n    delta = 1;\n  }\n  if (speed >= 10) {\n    delta = 5;\n  }\n  const nextSpeed = speed + delta;\n  return nextSpeed > 30 ? speed : nextSpeed;\n};\n\nconst decreaseSpeed = (speed) => {\n  let delta = 0.1;\n  if (speed > 1) {\n    delta = 1;\n  }\n  if (speed > 10) {\n    delta = 5;\n  }\n  const nextSpeed = speed - delta;\n  if (nextSpeed < 0.1) {\n    return speed;\n  }\n  return nextSpeed;\n};\n\nconst defaultRenderButton = (icon, onClick, title) => {\n  return (\n    <div\n      aria-label={title}\n      role=\"button\"\n      onClick={onClick}\n      onKeyPress={onClick}\n      className=\"rt-control-button\"\n      tabIndex={0}\n      title={title}\n    >\n      {icon}\n    </div>\n  );\n};\n\n/**\n * TrackerControl allows the user to control the speed of a\n * [mobility-toolbox-js tracker layer](https://mobility-toolbox-js.geops.io/api/class/src/mapbox/layers/TrajservLayer%20js~TrajservLayer%20html-offset-anchor).\n */\nfunction TrackerControl({\n  className,\n  iconDateReset,\n  iconSpeedDown,\n  iconSpeedReset,\n  iconSpeedUp,\n  iconSpeed,\n  renderButton,\n  trackerLayer,\n}) {\n  const [speed, setSpeed] = useState(1);\n\n  const onSpeedChange = (newSpeed) => {\n    // eslint-disable-next-line no-param-reassign\n    trackerLayer.speed = newSpeed;\n  };\n\n  const resetDate = () => {\n    trackerLayer.setCurrTime(new Date());\n  };\n\n  useEffect(() => {\n    onSpeedChange(speed);\n  }, [speed, onSpeedChange]);\n\n  return (\n    <div className={className}>\n      {renderButton(iconDateReset, () => resetDate(), 'reset date')}\n      {renderButton(\n        iconSpeedDown,\n        () => setSpeed(decreaseSpeed(speed)),\n        'speed down',\n      )}\n      {renderButton(iconSpeedReset, () => setSpeed(1), 'speed reset')}\n      {renderButton(\n        iconSpeedUp,\n        () => setSpeed(increaseSpeed(speed)),\n        'speed up',\n      )}\n      <div className=\"rt-tracker-speed\">\n        {iconSpeed}\n        {`${speed < 1 ? speed.toFixed(1) : speed}`}\n      </div>\n    </div>\n  );\n}\n\nTrackerControl.propTypes = {\n  /**\n   * CSS class of the tracker control.\n   */\n  className: PropTypes.string,\n\n  /**\n   * Icon of the date reset button.\n   */\n  iconDateReset: PropTypes.element,\n\n  /**\n   * Icon of the speed down button.\n   */\n  iconSpeedDown: PropTypes.element,\n\n  /**\n   * Icon of the speed up button.\n   */\n  iconSpeedUp: PropTypes.element,\n\n  /**\n   * Icon of the speed reset button.\n   */\n  iconSpeedReset: PropTypes.element,\n\n  /**\n   * Icon speed.\n   */\n  iconSpeed: PropTypes.element,\n\n  /**\n   * Render function for buttons.\n   */\n  renderButton: PropTypes.func,\n\n  /**\n   * Trackerlayer.\n   */\n  trackerLayer: PropTypes.instanceOf(TrackerLayer).isRequired,\n};\n\nTrackerControl.defaultProps = {\n  className: 'rt-tracker-control',\n  iconDateReset: <FaRegDotCircle />,\n  iconSpeedDown: <FaBackward />,\n  iconSpeedReset: <FaPlay />,\n  iconSpeedUp: <FaForward />,\n  iconSpeed: <IoIosSpeedometer />,\n  renderButton: defaultRenderButton,\n};\n\nexport default TrackerControl;\n"],"names":["const","let"],"mappings":"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"}