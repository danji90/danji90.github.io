{"version":3,"file":"FilterButton.js","sources":["../../../src/components/FilterButton/FilterButton.js"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport qs from 'query-string';\nimport PropTypes from 'prop-types';\nimport { TrackerLayer } from 'mobility-toolbox-js/ol';\n\nconst propTypes = {\n  /**\n   * CSS class of the filter button.\n   */\n  className: PropTypes.string,\n\n  /**\n   * Title.\n   */\n  title: PropTypes.string,\n\n  /**\n   * Line info route identifer.\n   */\n  routeIdentifier: PropTypes.string.isRequired,\n\n  /**\n   * Button is active.\n   */\n  active: PropTypes.bool.isRequired,\n\n  /**\n   * Function triggered on button click.\n   */\n  onClick: PropTypes.func.isRequired,\n\n  /**\n   * Trackerlayer.\n   */\n  trackerLayer: PropTypes.instanceOf(TrackerLayer).isRequired,\n\n  /**\n   * Children content of the button.\n   */\n  children: PropTypes.element.isRequired,\n};\n\nconst defaultProps = {\n  className: 'rt-route-filter',\n  title: 'Filter',\n};\n\n/**\n * Button enables the filtering of a selected train.\n */\nclass FilterButton extends PureComponent {\n  updatePermalink(isRemoving) {\n    const { routeIdentifier } = this.props;\n\n    const parameters = qs.parse(window.location.search.toLowerCase());\n    if (isRemoving) {\n      delete parameters.tripnumber;\n    } else {\n      parameters.tripnumber = parseInt(routeIdentifier.split('.')[0], 10);\n    }\n\n    const qStr = qs.stringify(parameters, { encode: false });\n    const search = `?${qStr}`;\n    const { hash } = window.location;\n    window.history.replaceState(undefined, undefined, `${search}${hash || ''}`);\n  }\n\n  toggleFilter(routeIdentifier) {\n    const { trackerLayer, active, onClick } = this.props;\n    const activated = !active;\n\n    if (trackerLayer) {\n      if (activated) {\n        this.updatePermalink(false);\n        [trackerLayer.tripNumber] = routeIdentifier.split('.');\n      } else {\n        this.updatePermalink(true);\n        trackerLayer.tripNumber = null;\n      }\n    }\n\n    onClick(activated);\n  }\n\n  render() {\n    const { className, title, routeIdentifier, active, children } = this.props;\n    const toggle = () => this.toggleFilter(routeIdentifier);\n\n    return (\n      <div\n        aria-label={title}\n        className={`${className}${active ? ' rt-active' : ''}`}\n        title={title}\n        onClick={toggle}\n        onKeyPress={(e) => e.which === 13 && toggle()}\n        role=\"button\"\n        tabIndex={0}\n      >\n        {children}\n      </div>\n    );\n  }\n}\n\nFilterButton.propTypes = propTypes;\nFilterButton.defaultProps = defaultProps;\n\nexport default FilterButton;\n"],"names":["const","this"],"mappings":"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"}