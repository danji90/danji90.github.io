{"ast":null,"code":"function objectWithoutProperties(obj, exclude) {\n  var target = {};\n\n  for (var k in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, k) && exclude.indexOf(k) === -1) target[k] = obj[k];\n  }\n\n  return target;\n}\n\nimport React, { useMemo, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Map } from 'ol';\nimport CopyrightControl from 'mobility-toolbox-js/ol/controls/CopyrightControl';\nvar propTypes = {\n  /**\n   * A map.\n   */\n  map: PropTypes.instanceOf(Map).isRequired,\n\n  /**\n   * Format function. Called with an array of copyrights from visible layers\n   * and returns the copyright.\n   */\n  format: PropTypes.func,\n\n  /**\n   * CSS class of th root element\n   */\n  className: PropTypes.string\n};\nvar defaultProps = {\n  format: function format(copyrights) {\n    return copyrights.join(' | ');\n  },\n  className: 'rs-copyright'\n};\n/**\n * The Copyright component uses the\n * [mobility-toolbox-js CopyrightControl](https://mobility-toolbox-js.geops.io/api/class/src/mapbox/controls/CopyrightControl%20js~CopyrightControl%20html-offset-anchor)\n * to render the layer copyrights.\n */\n\nfunction Copyright(ref) {\n  var map = ref.map;\n  var format = ref.format;\n  var rest = objectWithoutProperties(ref, [\"map\", \"format\"]);\n  var other = rest;\n  var ref$1 = useState([]);\n  var copyrights = ref$1[0];\n  var setCopyrights = ref$1[1];\n  var control = useMemo(function () {\n    return new CopyrightControl({\n      target: document.createElement('div'),\n      element: document.createElement('div'),\n      render: function render() {\n        // eslint-disable-next-line react/no-this-in-sfc\n        var newCopyrights = this.getCopyrights();\n\n        if (copyrights.toString() !== newCopyrights.toString()) {\n          setCopyrights(newCopyrights);\n        }\n      }\n    });\n  }, []); // Ensure the control is not associated to the wrong map\n\n  useEffect(function () {\n    if (!control) {\n      return function () {};\n    }\n\n    control.map = map;\n    return function () {\n      control.map = null;\n    };\n  }, [map, control]);\n\n  if (!control || !control.getCopyrights().length) {\n    return null;\n  }\n\n  return React.createElement('div', Object.assign({}, // eslint-disable-next-line react/jsx-props-no-spreading\n  other, {\n    dangerouslySetInnerHTML: {\n      __html: format(copyrights) || ''\n    }\n  }));\n}\n\nCopyright.propTypes = propTypes;\nCopyright.defaultProps = defaultProps;\nexport default React.memo(Copyright);","map":{"version":3,"sources":["../../../src/components/Copyright/Copyright.js"],"names":["const"],"mappings":";;;;;;;;;;AAAA,OAAO,KAAP,IAAgB,OAAhB,EAAyB,SAAzB,EAAoC,QAApC,QAAoD,OAApD;AACA,OAAO,SAAP,MAAsB,YAAtB;AACA,SAAS,GAAT,QAAoB,IAApB;AACA,OAAO,gBAAP,MAA6B,kDAA7B;AAEAA,IAAM,SAAS,GAAG;AAClB;AACA;AACA;AACE,EAAA,GAAG,EAAE,SAAS,CAAC,UAAV,CAAqB,GAArB,EAA0B,UAJf;;AAMlB;AACA;AACA;AACA;AACE,EAAA,MAAM,EAAE,SAAS,CAAC,IAVF;;AAYlB;AACA;AACA;AACE,EAAA,SAAS,EAAE,SAAS,CAAC;AAfL,CAAlBA;AAkBAA,IAAM,YAAY,GAAG;AACnB,EAAA,MAAM,EAAA,gBAAG,UAAH,EAAa;AAAA,WAAK,UAAU,CAAC,IAAX,CAAgB,KAAhB,CAAL;AAA2B,GAD3B;AAEnB,EAAA,SAAS,EAAE;AAFQ,CAArBA;AAKA;AACA;AACA;AACA;AACA;;AACA,SAAS,SAAT,CAAkB,GAAlB,EAAqB;gBAAK,G;mBAAQ,M;kDAAG,Q;;AACrC,MAAA,KAAmC,GAAG,QAAQ,CAAC,EAAD,CAA9C;AAAS,MAAA,UAAA,GAAA,KAAA,CAAA,CAAA,CAAA;AAAY,MAAA,aAAA,GAAA,KAAA,CAAA,CAAA,CAAA;AAEnBA,MAAM,OAAO,GAAG,OAAO,CAAA,YAAO;AAC5B,WAAO,IAAI,gBAAJ,CAAqB;AAC1B,MAAA,MAAM,EAAE,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CADkB;AAE1B,MAAA,OAAO,EAAE,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAFiB;AAG1B,MAAA,MAAA,EAAA,SAAA,MAAA,GAAS;AACf;AACQA,YAAM,aAAa,GAAG,KAAK,aAAL,EAAtBA;;AACA,YAAI,UAAU,CAAC,QAAX,OAA0B,aAAa,CAAC,QAAd,EAA9B,EAAwD;AACtD,UAAA,aAAa,CAAC,aAAD,CAAb;AACD;AACF;AATyB,KAArB,CAAP;AAWD,GAZsB,EAYpB,EAZoB,CAAvBA,CAHmB,CAiBrB;;AACE,EAAA,SAAS,CAAA,YAAO;AACd,QAAI,CAAC,OAAL,EAAc;AACZ,aAAA,YAAa,CAAE,CAAf;AACD;;AAED,IAAA,OAAO,CAAC,GAAR,GAAc,GAAd;AAEA,WAAA,YAAa;AACX,MAAA,OAAO,CAAC,GAAR,GAAc,IAAd;AACD,KAFD;AAGD,GAVQ,EAUN,CAAC,GAAD,EAAM,OAAN,CAVM,CAAT;;AAYA,MAAI,CAAC,OAAD,IAAY,CAAC,OAAO,CAAC,aAAR,GAAwB,MAAzC,EAAiD;AAC/C,WAAO,IAAP;AACD;;AAED,SACE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAC,MAAA,CAAA,MAAA,CAAA,EAAA,EACL;AACU,EAAA,KAFL,EAEW;AAEV,IAAA,uBAAA,EAAyB;AACvB,MAAA,MAAM,EAAE,MAAM,CAAC,UAAD,CAAN,IAAsB;AADP;AAFf,GAFX,CAAD,CADF;AAUD;;AAED,SAAS,CAAC,SAAV,GAAsB,SAAtB;AACA,SAAS,CAAC,YAAV,GAAyB,YAAzB;AAEA,eAAe,KAAK,CAAC,IAAN,CAAW,SAAX,CAAf","sourcesContent":["import React, { useMemo, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Map } from 'ol';\nimport CopyrightControl from 'mobility-toolbox-js/ol/controls/CopyrightControl';\n\nconst propTypes = {\n  /**\n   * A map.\n   */\n  map: PropTypes.instanceOf(Map).isRequired,\n\n  /**\n   * Format function. Called with an array of copyrights from visible layers\n   * and returns the copyright.\n   */\n  format: PropTypes.func,\n\n  /**\n   * CSS class of th root element\n   */\n  className: PropTypes.string,\n};\n\nconst defaultProps = {\n  format: (copyrights) => copyrights.join(' | '),\n  className: 'rs-copyright',\n};\n\n/**\n * The Copyright component uses the\n * [mobility-toolbox-js CopyrightControl](https://mobility-toolbox-js.geops.io/api/class/src/mapbox/controls/CopyrightControl%20js~CopyrightControl%20html-offset-anchor)\n * to render the layer copyrights.\n */\nfunction Copyright({ map, format, ...other }) {\n  const [copyrights, setCopyrights] = useState([]);\n\n  const control = useMemo(() => {\n    return new CopyrightControl({\n      target: document.createElement('div'),\n      element: document.createElement('div'),\n      render() {\n        // eslint-disable-next-line react/no-this-in-sfc\n        const newCopyrights = this.getCopyrights();\n        if (copyrights.toString() !== newCopyrights.toString()) {\n          setCopyrights(newCopyrights);\n        }\n      },\n    });\n  }, []);\n\n  // Ensure the control is not associated to the wrong map\n  useEffect(() => {\n    if (!control) {\n      return () => {};\n    }\n\n    control.map = map;\n\n    return () => {\n      control.map = null;\n    };\n  }, [map, control]);\n\n  if (!control || !control.getCopyrights().length) {\n    return null;\n  }\n\n  return (\n    <div\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      {...other}\n      // eslint-disable-next-line react/no-danger\n      dangerouslySetInnerHTML={{\n        __html: format(copyrights) || '',\n      }}\n    />\n  );\n}\n\nCopyright.propTypes = propTypes;\nCopyright.defaultProps = defaultProps;\n\nexport default React.memo(Copyright);\n"]},"metadata":{},"sourceType":"module"}