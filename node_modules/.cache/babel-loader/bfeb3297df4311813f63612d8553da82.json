{"ast":null,"code":"import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { defaults as defaultInteractions } from 'ol/interaction';\nimport { equals } from 'ol/extent';\nimport OLMap from 'ol/Map';\nimport OLCollection from 'ol/Collection';\nimport View from 'ol/View';\nimport { unByKey } from 'ol/Observable';\nimport Interaction from 'ol/interaction/Interaction';\nimport { Layer } from 'mobility-toolbox-js/ol';\nimport ResizeHandler from '../ResizeHandler';\nvar propTypes = {\n  /** Map animation options */\n  animationOptions: PropTypes.shape({\n    center: PropTypes.arrayOf(PropTypes.number),\n    resolution: PropTypes.number,\n    zoom: PropTypes.number\n  }),\n\n  /** Center of the [ol/View](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html). */\n  center: PropTypes.arrayOf(PropTypes.number),\n\n  /** Class name of the map container */\n  className: PropTypes.string,\n\n  /** Map extent */\n  extent: PropTypes.arrayOf(PropTypes.number),\n\n  /** Openlayers [fit options](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html#fit) when extent is updated */\n  fitOptions: PropTypes.object,\n\n  /** Array of [ol/interaction](https://openlayers.org/en/latest/apidoc/module-ol_interaction_Interaction-Interaction.html). */\n  interactions: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.instanceOf(Interaction)), PropTypes.instanceOf(OLCollection)]),\n\n  /** Array of [mobility-toolbox-js layers](https://mobility-toolbox-js.geops.io/api/identifiers%20html#ol-layers) to display. */\n  layers: PropTypes.arrayOf(PropTypes.instanceOf(Layer)),\n\n  /** An [ol/map](https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html). */\n  map: PropTypes.instanceOf(OLMap),\n\n  /**\n   * Callback when a [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html) is clicked.\n   * @param {OLFeature[]} features An array of [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html).\n   * @param {ol.MapBrowserEvent} event The singleclick [ol/MapBrowserEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:singleclick).\n   */\n  onFeaturesClick: PropTypes.func,\n\n  /**\n   * Optional options to pass on feature click. Passed to ol's 'getFeaturesAtPixel' method.\n   * https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html#getFeaturesAtPixel\n   */\n  featuresClickOptions: PropTypes.shape({\n    layerFilter: PropTypes.func,\n    hitTolerance: PropTypes.number,\n    checkWrapped: PropTypes.bool\n  }),\n\n  /**\n   * Callback when a [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html) is hovered.\n   * @param {OLFeature[]} features An array of [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html).\n   * @param {ol.MapBrowserEvent} event The pointermove [ol/MapBrowserEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:pointermove).\n   */\n  onFeaturesHover: PropTypes.func,\n\n  /**\n   * Callback when the map was moved.\n   * @param {ol.MapEvent} event The movend [ol/MapEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:moveend).\n   */\n  onMapMoved: PropTypes.func,\n\n  /** Map resolution */\n  resolution: PropTypes.number,\n\n  /** The tabIndex of the map. */\n  tabIndex: PropTypes.number,\n\n  /** The style of the map. */\n  style: PropTypes.object,\n\n  /** HTML aria-label. */\n  ariaLabel: PropTypes.string,\n\n  /** [ol/View](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html) constructor options */\n  viewOptions: PropTypes.shape({\n    minZoom: PropTypes.number,\n    maxZoom: PropTypes.number,\n    extent: PropTypes.array,\n    projection: PropTypes.string\n  }),\n\n  /** Map zoom level */\n  zoom: PropTypes.number\n};\nvar defaultProps = {\n  animationOptions: undefined,\n  center: [0, 0],\n  className: 'rs-map',\n  extent: undefined,\n  fitOptions: {\n    duration: 1000,\n    padding: [20, 20, 20, 20],\n    maxZoom: 23\n  },\n  style: undefined,\n  interactions: null,\n  layers: [],\n  map: null,\n  onFeaturesClick: undefined,\n  featuresClickOptions: {\n    hitTolerance: 0\n  },\n  onFeaturesHover: undefined,\n  onMapMoved: undefined,\n  resolution: undefined,\n  tabIndex: undefined,\n  ariaLabel: 'map',\n  viewOptions: {\n    minZoom: 0,\n    maxZoom: 22,\n    extent: undefined,\n    projection: 'EPSG:3857'\n  },\n  zoom: 1\n};\n/**\n * The BasicMap component renders an [ol/map](https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html).\n *\n * The map's view is created with the following parameters for the view:\n *  - projection: 'EPSG:3857'\n *  - zoom: 0\n *  - minZoom: 0\n *  - maxZoom: 22\n *\n * These options can be overridden using the viewOptions property.\n */\n\nvar BasicMap = /*@__PURE__*/function (PureComponent) {\n  function BasicMap(props) {\n    PureComponent.call(this, props);\n    var ref = this.props;\n    var map = ref.map;\n    var interactions = ref.interactions;\n    this.map = map || new OLMap({\n      controls: [],\n      interactions: interactions || defaultInteractions({\n        altShiftDragRotate: false,\n        pinchRotate: false\n      })\n    });\n    this.state = {\n      node: null\n    };\n    this.layers = [];\n    this.moveEndRef = null;\n    this.singleClickRef = null;\n    this.pointerMoveRef = null;\n    this.setNode = this.setNode.bind(this);\n  }\n\n  if (PureComponent) BasicMap.__proto__ = PureComponent;\n  BasicMap.prototype = Object.create(PureComponent && PureComponent.prototype);\n  BasicMap.prototype.constructor = BasicMap;\n\n  BasicMap.prototype.componentDidMount = function componentDidMount() {\n    var ref = this.props;\n    var layers = ref.layers;\n    var extent = ref.extent;\n    var viewOptions = ref.viewOptions;\n    var center = ref.center;\n    var zoom = ref.zoom;\n    var resolution = ref.resolution;\n    var ref$1 = this.state;\n    var node = ref$1.node;\n    this.map.setTarget(node); // We set the view here otherwise the map is not correctly zoomed.\n\n    this.map.setView(new View(Object.assign({}, viewOptions, {\n      center: center,\n      zoom: zoom,\n      resolution: resolution\n    }))); // // Since ol 6.1.0 touch-action is set to auto and creates a bad navigation experience on mobile,\n    // // so we have to force it to none for mobile.\n    // // https://github.com/openlayers/openlayers/pull/10187/files\n\n    var viewPort = this.map.getViewport();\n    viewPort.style.touchAction = 'none';\n    viewPort.style.msTouchAction = 'none';\n    viewPort.setAttribute('touch-action', 'none'); // Fit only work if the map has a size.\n\n    if (this.map.getSize() && extent) {\n      this.map.getView().fit(extent);\n    }\n\n    this.setLayers(layers);\n    this.listenMoveEnd();\n    this.listenSingleClick();\n    this.listenPointerMove();\n  };\n\n  BasicMap.prototype.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n    var ref = this.props;\n    var animationOptions = ref.animationOptions;\n    var center = ref.center;\n    var extent = ref.extent;\n    var fitOptions = ref.fitOptions;\n    var layers = ref.layers;\n    var resolution = ref.resolution;\n    var viewOptions = ref.viewOptions;\n    var zoom = ref.zoom;\n    var onMapMoved = ref.onMapMoved;\n    var onFeaturesClick = ref.onFeaturesClick;\n    var onFeaturesHover = ref.onFeaturesHover;\n    var ref$1 = this.state;\n    var node = ref$1.node;\n\n    if (prevState.node !== node) {\n      this.map.setTarget(node); // When the node is set we reinitialize the extent with the extent property.\n\n      if (!prevState.node && node && extent) {\n        this.map.getView().fit(extent);\n      }\n    }\n\n    if (prevProps.layers !== layers) {\n      this.setLayers(layers);\n    } // Creates a new view if necessary before updating the others prop.\n\n\n    if (viewOptions && JSON.stringify(viewOptions) !== JSON.stringify(prevProps.viewOptions)) {\n      // Re-create a view, ol doesn't provide any method to setExtent of view.\n      this.map.setView(new View(Object.assign({}, viewOptions, {\n        center: center,\n        resolution: resolution,\n        zoom: zoom\n      })));\n    }\n\n    var view = this.map.getView();\n\n    if (animationOptions && prevProps.animationOptions !== animationOptions) {\n      view.animate(animationOptions);\n    }\n\n    if (prevProps.center !== center) {\n      view.setCenter(center);\n    }\n\n    if (zoom !== prevProps.zoom) {\n      view.setZoom(zoom);\n    }\n\n    if (resolution !== prevProps.resolution) {\n      view.setResolution(resolution);\n    }\n\n    if (extent && !equals(extent, prevProps.extent || [])) {\n      view.fit(extent, fitOptions);\n    }\n\n    if (onMapMoved !== prevProps.onMapMoved) {\n      this.listenMoveEnd();\n    }\n\n    if (onFeaturesClick !== prevProps.onFeaturesClick) {\n      this.listenSingleClick();\n    }\n\n    if (onFeaturesHover !== prevProps.onFeaturesHover) {\n      this.listenPointerMove();\n    }\n  };\n\n  BasicMap.prototype.componentWillUnmount = function componentWillUnmount() {\n    unByKey([this.moveEndRef, this.singleClickRef, this.pointerMoveRef]);\n  };\n\n  BasicMap.prototype.setNode = function setNode(node) {\n    this.setState({\n      node: node\n    });\n  };\n\n  BasicMap.prototype.setLayers = function setLayers(layers) {\n    var this$1 = this;\n    if (layers === void 0) layers = [];\n    var layersToRemove = this.layers.filter(function (layer) {\n      return !layers.includes(layer);\n    });\n\n    for (var i = 0; i < layersToRemove.length; i += 1) {\n      this.terminateLayer(layersToRemove[i]);\n    }\n\n    var layersToInit = layers.filter(function (layer) {\n      return !this$1.layers.includes(layer);\n    });\n\n    for (var i$1 = 0; i$1 < layersToInit.length; i$1 += 1) {\n      this.initLayer(layersToInit[i$1]);\n    }\n\n    this.layers = layers;\n  };\n\n  BasicMap.prototype.initLayer = function initLayer(layer) {\n    layer.init(this.map);\n\n    if (layer.olLayer && this.map.getLayers() && !this.map.getLayers().getArray().includes(layer.olLayer)) {\n      this.map.addLayer(layer.olLayer);\n    }\n\n    var layers = layer.children || [];\n\n    for (var i = 0; i < layers.length; i += 1) {\n      this.initLayer(layers[i]);\n    }\n  };\n\n  BasicMap.prototype.terminateLayer = function terminateLayer(layer) {\n    if (layer.olLayer && this.map.getLayers() && this.map.getLayers().getArray().includes(layer.olLayer)) {\n      this.map.removeLayer(layer.olLayer);\n    }\n\n    layer.terminate(this.map);\n    var layers = layer.children || [];\n\n    for (var i = 0; i < layers.length; i += 1) {\n      this.terminateLayer(layers[i]);\n    }\n  };\n\n  BasicMap.prototype.listenMoveEnd = function listenMoveEnd() {\n    var ref = this.props;\n    var onMapMoved = ref.onMapMoved;\n    unByKey(this.moveEndRef);\n\n    if (!onMapMoved) {\n      return;\n    }\n\n    this.moveEndRef = this.map.on('moveend', function (evt) {\n      return onMapMoved(evt);\n    });\n  };\n\n  BasicMap.prototype.listenSingleClick = function listenSingleClick() {\n    var ref = this.props;\n    var onFeaturesClick = ref.onFeaturesClick;\n    var featuresClickOptions = ref.featuresClickOptions;\n    unByKey(this.singleClickRef);\n\n    if (!onFeaturesClick) {\n      return;\n    }\n\n    this.singleClickRef = this.map.on('singleclick', function (evt) {\n      var features = evt.map.getFeaturesAtPixel(evt.pixel, featuresClickOptions);\n      onFeaturesClick(features || [], evt);\n    });\n  };\n\n  BasicMap.prototype.listenPointerMove = function listenPointerMove() {\n    var ref = this.props;\n    var onFeaturesHover = ref.onFeaturesHover;\n    unByKey(this.pointerMoveRef);\n\n    if (!onFeaturesHover) {\n      return;\n    }\n\n    this.pointerMoveRef = this.map.on('pointermove', function (evt) {\n      var features = evt.map.getFeaturesAtPixel(evt.pixel);\n      onFeaturesHover(features || [], evt);\n    });\n  };\n\n  BasicMap.prototype.render = function render() {\n    var this$1 = this;\n    var ref = this.props;\n    var className = ref.className;\n    var tabIndex = ref.tabIndex;\n    var ariaLabel = ref.ariaLabel;\n    var style = ref.style;\n    var ref$1 = this.state;\n    var node = ref$1.node;\n    return React.createElement('div', {\n      className: className,\n      ref: this.setNode,\n      role: \"presentation\",\n      'aria-label': ariaLabel,\n      tabIndex: tabIndex,\n      style: style\n    }, React.createElement(ResizeHandler, {\n      maxHeightBrkpts: null,\n      maxWidthBrkpts: null,\n      observe: node,\n      onResize: function onResize() {\n        this$1.map.updateSize();\n      }\n    }));\n  };\n\n  return BasicMap;\n}(PureComponent);\n\nBasicMap.propTypes = propTypes;\nBasicMap.defaultProps = defaultProps;\nexport default BasicMap;","map":{"version":3,"sources":["../../../src/components/BasicMap/BasicMap.js"],"names":["const","super","let","this","i"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { defaults as defaultInteractions } from 'ol/interaction';\nimport { equals } from 'ol/extent';\nimport OLMap from 'ol/Map';\nimport OLCollection from 'ol/Collection';\nimport View from 'ol/View';\nimport { unByKey } from 'ol/Observable';\nimport Interaction from 'ol/interaction/Interaction';\nimport { Layer } from 'mobility-toolbox-js/ol';\nimport ResizeHandler from '../ResizeHandler';\n\nconst propTypes = {\n  /** Map animation options */\n  animationOptions: PropTypes.shape({\n    center: PropTypes.arrayOf(PropTypes.number),\n    resolution: PropTypes.number,\n    zoom: PropTypes.number,\n  }),\n\n  /** Center of the [ol/View](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html). */\n  center: PropTypes.arrayOf(PropTypes.number),\n\n  /** Class name of the map container */\n  className: PropTypes.string,\n\n  /** Map extent */\n  extent: PropTypes.arrayOf(PropTypes.number),\n\n  /** Openlayers [fit options](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html#fit) when extent is updated */\n  fitOptions: PropTypes.object,\n\n  /** Array of [ol/interaction](https://openlayers.org/en/latest/apidoc/module-ol_interaction_Interaction-Interaction.html). */\n  interactions: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.instanceOf(Interaction)),\n    PropTypes.instanceOf(OLCollection),\n  ]),\n\n  /** Array of [mobility-toolbox-js layers](https://mobility-toolbox-js.geops.io/api/identifiers%20html#ol-layers) to display. */\n  layers: PropTypes.arrayOf(PropTypes.instanceOf(Layer)),\n\n  /** An [ol/map](https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html). */\n  map: PropTypes.instanceOf(OLMap),\n\n  /**\n   * Callback when a [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html) is clicked.\n   * @param {OLFeature[]} features An array of [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html).\n   * @param {ol.MapBrowserEvent} event The singleclick [ol/MapBrowserEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:singleclick).\n   */\n  onFeaturesClick: PropTypes.func,\n\n  /**\n   * Optional options to pass on feature click. Passed to ol's 'getFeaturesAtPixel' method.\n   * https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html#getFeaturesAtPixel\n   */\n  featuresClickOptions: PropTypes.shape({\n    layerFilter: PropTypes.func,\n    hitTolerance: PropTypes.number,\n    checkWrapped: PropTypes.bool,\n  }),\n\n  /**\n   * Callback when a [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html) is hovered.\n   * @param {OLFeature[]} features An array of [ol/Feature](https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html).\n   * @param {ol.MapBrowserEvent} event The pointermove [ol/MapBrowserEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:pointermove).\n   */\n  onFeaturesHover: PropTypes.func,\n\n  /**\n   * Callback when the map was moved.\n   * @param {ol.MapEvent} event The movend [ol/MapEvent](https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:moveend).\n   */\n  onMapMoved: PropTypes.func,\n\n  /** Map resolution */\n  resolution: PropTypes.number,\n\n  /** The tabIndex of the map. */\n  tabIndex: PropTypes.number,\n\n  /** The style of the map. */\n  style: PropTypes.object,\n\n  /** HTML aria-label. */\n  ariaLabel: PropTypes.string,\n\n  /** [ol/View](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html) constructor options */\n  viewOptions: PropTypes.shape({\n    minZoom: PropTypes.number,\n    maxZoom: PropTypes.number,\n    extent: PropTypes.array,\n    projection: PropTypes.string,\n  }),\n\n  /** Map zoom level */\n  zoom: PropTypes.number,\n};\n\nconst defaultProps = {\n  animationOptions: undefined,\n  center: [0, 0],\n  className: 'rs-map',\n  extent: undefined,\n  fitOptions: {\n    duration: 1000,\n    padding: [20, 20, 20, 20],\n    maxZoom: 23,\n  },\n  style: undefined,\n  interactions: null,\n  layers: [],\n  map: null,\n  onFeaturesClick: undefined,\n  featuresClickOptions: {\n    hitTolerance: 0,\n  },\n  onFeaturesHover: undefined,\n  onMapMoved: undefined,\n  resolution: undefined,\n  tabIndex: undefined,\n  ariaLabel: 'map',\n  viewOptions: {\n    minZoom: 0,\n    maxZoom: 22,\n    extent: undefined,\n    projection: 'EPSG:3857',\n  },\n  zoom: 1,\n};\n\n/**\n * The BasicMap component renders an [ol/map](https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html).\n *\n * The map's view is created with the following parameters for the view:\n *  - projection: 'EPSG:3857'\n *  - zoom: 0\n *  - minZoom: 0\n *  - maxZoom: 22\n *\n * These options can be overridden using the viewOptions property.\n */\nclass BasicMap extends PureComponent {\n  constructor(props) {\n    super(props);\n    const { map, interactions } = this.props;\n\n    this.map =\n      map ||\n      new OLMap({\n        controls: [],\n        interactions:\n          interactions ||\n          defaultInteractions({\n            altShiftDragRotate: false,\n            pinchRotate: false,\n          }),\n      });\n\n    this.state = {\n      node: null,\n    };\n\n    this.layers = [];\n    this.moveEndRef = null;\n    this.singleClickRef = null;\n    this.pointerMoveRef = null;\n    this.setNode = this.setNode.bind(this);\n  }\n\n  componentDidMount() {\n    const {\n      layers,\n      extent,\n      viewOptions,\n      center,\n      zoom,\n      resolution,\n    } = this.props;\n    const { node } = this.state;\n    this.map.setTarget(node);\n\n    // We set the view here otherwise the map is not correctly zoomed.\n    this.map.setView(new View({ ...viewOptions, center, zoom, resolution }));\n\n    // // Since ol 6.1.0 touch-action is set to auto and creates a bad navigation experience on mobile,\n    // // so we have to force it to none for mobile.\n    // // https://github.com/openlayers/openlayers/pull/10187/files\n    const viewPort = this.map.getViewport();\n    viewPort.style.touchAction = 'none';\n    viewPort.style.msTouchAction = 'none';\n    viewPort.setAttribute('touch-action', 'none');\n\n    // Fit only work if the map has a size.\n    if (this.map.getSize() && extent) {\n      this.map.getView().fit(extent);\n    }\n\n    this.setLayers(layers);\n    this.listenMoveEnd();\n    this.listenSingleClick();\n    this.listenPointerMove();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const {\n      animationOptions,\n      center,\n      extent,\n      fitOptions,\n      layers,\n      resolution,\n      viewOptions,\n      zoom,\n      onMapMoved,\n      onFeaturesClick,\n      onFeaturesHover,\n    } = this.props;\n    const { node } = this.state;\n\n    if (prevState.node !== node) {\n      this.map.setTarget(node);\n\n      // When the node is set we reinitialize the extent with the extent property.\n      if (!prevState.node && node && extent) {\n        this.map.getView().fit(extent);\n      }\n    }\n\n    if (prevProps.layers !== layers) {\n      this.setLayers(layers);\n    }\n\n    // Creates a new view if necessary before updating the others prop.\n    if (\n      viewOptions &&\n      JSON.stringify(viewOptions) !== JSON.stringify(prevProps.viewOptions)\n    ) {\n      // Re-create a view, ol doesn't provide any method to setExtent of view.\n      this.map.setView(\n        new View({\n          ...viewOptions,\n          center,\n          resolution,\n          zoom,\n        }),\n      );\n    }\n\n    const view = this.map.getView();\n\n    if (animationOptions && prevProps.animationOptions !== animationOptions) {\n      view.animate(animationOptions);\n    }\n\n    if (prevProps.center !== center) {\n      view.setCenter(center);\n    }\n\n    if (zoom !== prevProps.zoom) {\n      view.setZoom(zoom);\n    }\n\n    if (resolution !== prevProps.resolution) {\n      view.setResolution(resolution);\n    }\n\n    if (extent && !equals(extent, prevProps.extent || [])) {\n      view.fit(extent, fitOptions);\n    }\n\n    if (onMapMoved !== prevProps.onMapMoved) {\n      this.listenMoveEnd();\n    }\n\n    if (onFeaturesClick !== prevProps.onFeaturesClick) {\n      this.listenSingleClick();\n    }\n\n    if (onFeaturesHover !== prevProps.onFeaturesHover) {\n      this.listenPointerMove();\n    }\n  }\n\n  componentWillUnmount() {\n    unByKey([this.moveEndRef, this.singleClickRef, this.pointerMoveRef]);\n  }\n\n  setNode(node) {\n    this.setState({ node });\n  }\n\n  setLayers(layers = []) {\n    const layersToRemove = this.layers.filter(\n      (layer) => !layers.includes(layer),\n    );\n    for (let i = 0; i < layersToRemove.length; i += 1) {\n      this.terminateLayer(layersToRemove[i]);\n    }\n\n    const layersToInit = layers.filter((layer) => !this.layers.includes(layer));\n    for (let i = 0; i < layersToInit.length; i += 1) {\n      this.initLayer(layersToInit[i]);\n    }\n    this.layers = layers;\n  }\n\n  initLayer(layer) {\n    layer.init(this.map);\n    if (\n      layer.olLayer &&\n      this.map.getLayers() &&\n      !this.map.getLayers().getArray().includes(layer.olLayer)\n    ) {\n      this.map.addLayer(layer.olLayer);\n    }\n    const layers = layer.children || [];\n    for (let i = 0; i < layers.length; i += 1) {\n      this.initLayer(layers[i]);\n    }\n  }\n\n  terminateLayer(layer) {\n    if (\n      layer.olLayer &&\n      this.map.getLayers() &&\n      this.map.getLayers().getArray().includes(layer.olLayer)\n    ) {\n      this.map.removeLayer(layer.olLayer);\n    }\n    layer.terminate(this.map);\n    const layers = layer.children || [];\n    for (let i = 0; i < layers.length; i += 1) {\n      this.terminateLayer(layers[i]);\n    }\n  }\n\n  listenMoveEnd() {\n    const { onMapMoved } = this.props;\n    unByKey(this.moveEndRef);\n\n    if (!onMapMoved) {\n      return;\n    }\n\n    this.moveEndRef = this.map.on('moveend', (evt) => onMapMoved(evt));\n  }\n\n  listenSingleClick() {\n    const { onFeaturesClick, featuresClickOptions } = this.props;\n    unByKey(this.singleClickRef);\n\n    if (!onFeaturesClick) {\n      return;\n    }\n\n    this.singleClickRef = this.map.on('singleclick', (evt) => {\n      const features = evt.map.getFeaturesAtPixel(\n        evt.pixel,\n        featuresClickOptions,\n      );\n      onFeaturesClick(features || [], evt);\n    });\n  }\n\n  listenPointerMove() {\n    const { onFeaturesHover } = this.props;\n    unByKey(this.pointerMoveRef);\n\n    if (!onFeaturesHover) {\n      return;\n    }\n\n    this.pointerMoveRef = this.map.on('pointermove', (evt) => {\n      const features = evt.map.getFeaturesAtPixel(evt.pixel);\n      onFeaturesHover(features || [], evt);\n    });\n  }\n\n  render() {\n    const { className, tabIndex, ariaLabel, style } = this.props;\n    const { node } = this.state;\n    return (\n      <div\n        className={className}\n        ref={this.setNode}\n        role=\"presentation\"\n        aria-label={ariaLabel}\n        tabIndex={tabIndex}\n        style={style}\n      >\n        <ResizeHandler\n          maxHeightBrkpts={null}\n          maxWidthBrkpts={null}\n          observe={node}\n          onResize={() => {\n            this.map.updateSize();\n          }}\n        />\n      </div>\n    );\n  }\n}\n\nBasicMap.propTypes = propTypes;\nBasicMap.defaultProps = defaultProps;\n\nexport default BasicMap;\n"]},"metadata":{},"sourceType":"module"}